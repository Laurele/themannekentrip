var app={Models:{},Collections:{},Views:{Navigation:{},Background:{},Gallery:{}},Dispatcher:{}};app.Dispatcher=_.extend({},Backbone.Events),function(){this.ScrollBar=function(i){this.$selector=i,this.axis=this.$selector.data("scrollbar")||"y"},ScrollBar.prototype.render=function(){var i={};"y"===this.axis&&(i.suppressScrollX=1),"x"===this.axis&&(i.suppressScrollY=1),this.$selector.perfectScrollbar(i)},ScrollBar.prototype.update=function(){this.$selector.perfectScrollbar("update")},$(document).ready(function(){"use strict";$("[data-scrollbar]").each(function(i,t){var e=new ScrollBar($(t));e.render(),console.log('ScrollBar rendered for [class="'+$(t).attr("class")+'"]'),$(window).resize(function(){e.update()})})})}(),$(function(){"use strict";var i=$('[data-view="gallery"]'),t="[data-thumbnail]",e="[data-slideshow]",a="[data-slideshow-content]",n="[data-slideshow-footer]",s="[data-slideshow-aside]",o="[data-slideshow-image]",d="[data-navigation]",l="is-active";if(app.Views.Gallery=Backbone.View.extend({el:i,count:null,currentIndex:null,images:{},$slideshow:null,arrowLeftKeyCode:37,arrowRightKeyCode:39,escapeKeyCode:27,initialize:function(){},events:{"click [data-thumbnail]":"clickThumbnail"},clickThumbnail:function(i){i.preventDefault();var t=$(i.currentTarget);this.currentIndex=parseInt(t.attr("data-item")),null!==this.$slideshow?(this._slide(),this.$slideshow.show()):this.render()},clickNext:function(){var i=Object.keys(this.images).length;this.currentIndex=(this.currentIndex+1)%i,this._slide()},clickPrevious:function(){var i=Object.keys(this.images).length;this.currentIndex=(this.currentIndex+i-1)%i,this._slide()},clickMiniature:function(i){i.preventDefault(),this.currentIndex=parseInt($(i.currentTarget).attr("data-miniature")),this._slide()},close:function(){this.$slideshow.hide()},open:function(){this.$slideshow.show()},changeSlideWithKeyboard:function(i){var t=i.keyCode||i.which;t===this.arrowLeftKeyCode?this.clickPrevious():t===this.arrowRightKeyCode?this.clickNext():t===this.escapeKeyCode&&this.close()},_slide:function(){$(o).removeClass(l);var i=$('[data-slideshow-image="'+this.currentIndex+'"]');i.addClass(l)},_appendTitle:function(i,t){""!==t.title&&i.append('<div class="my-slideshow-title">'+t.title+"</div>")},_appendCaption:function(i,t){""!==t.caption&&i.append('<div class="my-slideshow-caption">'+t.caption+"</div>")},_appendPicture:function(i,t){i.find(".my-slideshow-image").append('<div class="my-slideshow-picture"><div class="my-slideshow-picture-asset" style="background-image: url('+t.url+')"></div></div>'),i.append("<div data-slideshow-aside></div>");var e=$(s,i);this._appendTitle(e,t),this._appendCaption(e,t)},_appendMiniature:function(i,t){this.$miniatures.append('<div data-miniature="'+i.attr("data-image")+'" class="my-slideshow-miniature" style="background-image: url('+t.miniature+')"></div>')},_appendSlideshow:function(){$("body").append("<div data-slideshow></div>"),this.$slideshow=$(e),this.$slideshow.append("<div data-slideshow-content></div>"),this.$slideshowContent=$(a),this.$slideshow.append("<div data-slideshow-footer></div>"),this.$slideshowFooter=$(n),this.$slideshowFooter.append('<div class="my-slideshow-navigation--miniatures" data-el="navigation-miniatures"></div>'),this.$miniatures=$('[data-el="navigation-miniatures"]')},_appendNavigation:function(){this.$slideshow.append("<div data-navigation>"),this.$navigation=$(d),this.$navigation.append('<button class="my-slideshow-navigation--button icon-times" data-el="navigation-button-close"></button>'),this.$navigation.append('<button class="my-slideshow-navigation--button icon-chevron-left" data-el="navigation-button-previous"></button>'),this.$navigation.append('<button class="my-slideshow-navigation--button icon-chevron-right" data-el="navigation-button-next"></button>')},render:function(){return this.$thumbnails=$(t,this.$el),this.count=this.$thumbnails.length,this.count>0&&(this._appendSlideshow(),this._appendNavigation(),$.each(this.$thumbnails,_.bind(function(i,t){var e=$(t),a=parseInt(e.attr("data-item"));this.images[a]={title:e.attr("data-title"),caption:e.attr("data-caption"),url:e.attr("data-url"),miniature:e.attr("data-miniature-url")},this.$slideshowContent.append('<div data-slideshow-image="'+a+'"><div class="my-slideshow-image"></div></div>');var n=this.images[a],s=$('[data-slideshow-image="'+a+'"]');a===this.currentIndex&&s.addClass(l),this._appendPicture(s,n),this._appendMiniature(s,n)},this)),$(document).on("click",'[data-el="navigation-button-next"]',_.bind(function(i){i.preventDefault(),this.clickNext()},this)),$(document).on("click",'[data-el="navigation-button-previous"]',_.bind(function(i){i.preventDefault(),this.clickPrevious()},this)),$(document).on("click",'[data-el="navigation-button-close"]',_.bind(function(i){i.preventDefault(),this.close()},this)),$(document).on("click","[data-miniature]",_.bind(this.clickMiniature,this)),$(document).bind("keyup",_.bind(this.changeSlideWithKeyboard,this)),this.$slideshow.show()),this}}),i.length>0){new app.Views.Gallery}}()),$(function(){"use strict";var i=$('[data-view="background.main"]'),t=[1,2,3,4],e=0;if(app.Views.Background.Main=Backbone.View.extend({el:i,initialize:function(){var i=this;this.backgroundId=e,setInterval(function(){i._changeBackground()},9e3)},events:{'click [data-el="topbar-menu-toggle"]':"toggleBackground"},_changeBackground:function(){var i=t.length,e=this.backgroundId,a=(this.backgroundId+1)%i;this.backgroundId=a,$('[data-el="item-'+t[a]+'"]',this.$el).addClass("is-visible"),setTimeout(_.bind(function(){$('[data-el="item-'+t[e]+'"]',this.$el).removeClass("is-visible")},this),150)},render:function(){return this}}),i.length>0){var a=new app.Views.Background.Main;a.render()}}()),$(function(){"use strict";var i=$('[data-view="navigation.main"]'),t='[data-el="site-aside-menu"]',e='[data-el="topbar-menu-toggle"]',a="is-visible",n="is-opened",s="is-overflow-hidden";if(app.Views.Navigation.Main=Backbone.View.extend({el:i,initialize:function(){this.$navigation=$(t,this.$el),this.$button=$(e,this.$el),this.$html=$("html")},events:{'click [data-el="topbar-menu-toggle"]':"toggleNavigation"},toggleNavigation:function(i){i.preventDefault(),this.$navigation.toggleClass(a),this.$button.toggleClass(n),this.$html.toggleClass(s)},render:function(){return this}}),i.length>0){var o=new app.Views.Navigation.Main;o.render()}}());